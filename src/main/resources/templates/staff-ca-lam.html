<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Chọn ca làm</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <style>
        body {
            background: #f3f6fb;
            padding: 20px;
        }

        .card-ca {
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(15, 23, 42, 0.08);
            border: none;
        }

        .card-ca.active {
            border: 2px solid #1d4ed8;
        }
    </style>
</head>

<body>
    <div class="container">

        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h3>Chọn ca làm</h3>
                <p class="text-muted mb-0">
                    Nhân viên:
                    <b th:text="${nv != null ? nv.hoTen : '---'}"></b>
                </p>
            </div>
            <a href="/staff/home" class="btn btn-outline-secondary">← Về trang làm việc</a>
        </div>

        <div th:if="${errorMsg}" class="alert alert-danger" th:text="${errorMsg}"></div>

        <div class="row g-3">
            <div class="col-md-4" th:each="ca : ${dsCa}">
                <div class="card card-ca" th:classappend="${nv != null && nv.caLam != null
                                  && nv.caLam.maCa == ca.maCa} ? ' active'">
                    <div class="card-body">
                        <h5 class="card-title">
                            Ca #<span th:text="${ca.maCa}"></span>
                        </h5>
                        <p class="card-text mb-1">
                            Giờ làm:
                            <b th:text="${#temporals.format(ca.gioBatDau,'HH:mm')
                                     + ' - ' +
                                     #temporals.format(ca.gioKetThuc,'HH:mm')}"></b>
                        </p>
                        <p class="text-muted mb-3">
                            Ngày làm việc:
                            <span th:text="${#temporals.format(ca.ngayLamViec,'dd/MM/yyyy')}"></span>
                        </p>

                        <form th:action="@{/staff/ca-lam/chon}" method="post">
                            <input type="hidden" name="maCa" th:value="${ca.maCa}">
                            <button type="submit" class="btn btn-primary w-100" th:if="${nv == null || nv.caLam == null
                                       || nv.caLam.maCa != ca.maCa}">
                                Chọn ca này
                            </button>
                            <button type="button" class="btn btn-outline-secondary w-100" th:if="${nv != null && nv.caLam != null
                                       && nv.caLam.maCa == ca.maCa}" disabled>
                                Đang chọn ca này
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

    </div>
</body>

</html>